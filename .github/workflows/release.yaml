name: Release

on:
  push:
    tags:
      - 'v*'

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Build and run dev container task
        uses: devcontainers/ci@v0.2
        with:
          imageName: ghcr.io/${{ github.repository_owner }}/${{ github.repository_name }}
          runCmd: pnpm -r publish --access public --no-git-checks
          env: |
            NODE_AUTH_TOKEN=${{secrets.NPM_TOKEN}}